<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
		<link rel="icon" href="../img/favicon.ico" type="image/x-icon" />
		<title>Java IO 技术</title>
		<script type="text/javascript" src="../jquery-1.11.1/jquery.min.js"></script>
		<script type="text/javascript" src="../js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../js/net5ijy.js" ></script>
		<link href="../css/bootstrap.min.css" rel="stylesheet">
		<link href="../css/net5ijy.css" rel="stylesheet" >
	</head>
	<body>
		<nav class="navbar navbar-default navbar-fixed-top">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-target="#navbar-nav" data-toggle="collapse">
					<span class="sr-only"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a href="#" class="navbar-brand">
					<img src="../img/logo.png" width="50" height="50" class="logo" />
				</a>
			</div>
			<div id="navbar-nav" class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li><a href="index.html">首页</a></li>
					<li class="dropdown active">
						<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown">
							编程
							<span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="index.html">JAVA</a></li>
							<li><a href="../db/index.html">数据库</a></li>
						</ul>
					</li>
					<li><a href="help.html">帮助</a></li>
				</ul>
			</div>
		</nav>
		
		<div class="container main-container">
			<h4 class="title">第三十九节&nbsp;&nbsp;&nbsp;&nbsp;File 类型及文件操作</h4>
			<br />
			
			<ul class="list-unstyled">
				<li><a href="#f1">一、File 类</a></li>
				<li><a href="#f2">二、File 类基本操作</a></li>
				<li><a href="#f3">三、递归删除目录</a></li>
			</ul>
			<br />

			<h4 id="f1" class="title-1th">一、File 类</h4>

			<pre>
java.io;

public class File extends Object implements Serializable, Comparable&lt;File&gt; {}
</pre>

			<p>
				文件和目录路径名的抽象表示形式，封装了操作文件和目录的方法。
			</p>
			<p>
				<code>File</code> 类的实例是不可变的，一旦创建，<code>File</code> 对象表示的抽象路径名将永不改变。
			</p>

			<br/ >

			<p>
				<span class="high-light">字段</span>
			</p>

			<pre>
<span class="methodClassName">public static final String separator</span>
	系统默认名称分隔符。
</pre>

			<p>
				<span class="high-light">构造方法</span>
			</p>

			<pre>
<span class="methodClassName">public File(String pathname)</span>
	将给定路径名字符串转换为抽象路径名来创建一个新File对象。
</pre>

			<p>
				<span class="high-light">主要方法</span>
			</p>

			<pre>
<span class="methodClassName">public boolean canExecute()</span>
	测试应用程序是否可以执行此文件。

<span class="methodClassName">public boolean canRead()</span>
	测试应用程序是否可以读取此文件。

<span class="methodClassName">public boolean canWrite()</span>
	测试应用程序是否可以修改此文件。

<span class="methodClassName">public boolean exists()</span>
	测试此文件或目录是否存在。

<span class="methodClassName">public boolean isDirectory()</span>
	测试此File对象是否是一个目录。

<span class="methodClassName">public boolean isFile()</span>
	测试此File对象是否是一个标准文件。

<span class="methodClassName">public boolean createNewFile() throws IOException</span>
	当且仅当不存在具有此文件时，创建一个新的空文件。

	例子：
	File file = new File("D:" + File.separator + "a.txt");
		if (!file.exists())
			file.createNewFile();

<span class="methodClassName">public static File createTempFile(String prefix, String suffix, File directory) throws IOException</span>
	在指定目录(directory)使用给定前缀(prefix)和后缀(suffix)为名称创建新的空文件。

<span class="methodClassName">public static File createTempFile(String prefix, String suffix) throws IOException</span>
	在默认临时目录使用给定前缀(prefix)和后缀(suffix)为名称创建空文件。

<span class="methodClassName">public boolean mkdir()</span>
	创建此File对象指定的目录。

<span class="methodClassName">public boolean mkdirs()</span>
	创建此File对象指定的目录，包括所有必需但不存在的父目录。

<span class="methodClassName">public boolean delete()</span>
	删除此文件或目录。
	如果是目录，则必须为空才能删除。

<span class="methodClassName">public long lastModified()</span>
	返回此文件最后一次被修改时间。

<span class="methodClassName">public long length()</span>
	返回此文件的长度。

<span class="methodClassName">public String getAbsolutePath()</span>
	返回此文件的绝对路径名字符串。

<span class="methodClassName">public String getName()</span>
	返回此文件或目录的名称。

<span class="methodClassName">public String getPath()</span>
	获取路径名字符串。

<span class="methodClassName">public long getTotalSpace()</span>
	返回此文件所在分区大小。

<span class="methodClassName">public long getUsableSpace()</span>
	返回此文件所在分区上可用于虚拟机的字节数。

<span class="methodClassName">public String[] list()</span>
	返回一个字符串数组，指定此目录中的文件和子目录。

<span class="methodClassName">public String[] list(FilenameFilter filter)</span>
	返回一个字符串数组，指定此目录中满足过滤器的文件和子目录。

<span class="methodClassName">public File[] listFiles()</span>
	返回一个File对象数组，表示此File对象表示目录中的文件和子目录。

<span class="methodClassName">public File[] listFiles(FileFilter filter)</span>
	返回一个File对象数组，表示此File对象表示目录中满足过滤器的文件和子目录。

<span class="methodClassName">public File[] listFiles(FilenameFilter filter)</span>
	返回一个File对象数组，表示此File对象表示目录中满足过滤器的文件和子目录。

<span class="methodClassName">public static File[] listRoots()</span>
	列出可用的文件系统根。

<span class="methodClassName">public boolean renameTo(File dest)</span>
	重新命名此File对象表示的文件。
</pre>

			<hr />

			<h4 id="f2" class="title-1th">二、File 类基本操作</h4>

			<pre>
File file = new File("D:" + File.separator + "a.txt");

// File file = new File("a.txt");

<span class="annotation">// createNewFile、exists</span>
if (!file.exists())
	file.createNewFile();

// delete
// file.delete();

<span class="annotation">// getAbsolutePath</span>
String absolutePath = file.getAbsolutePath();
System.out.println(absolutePath);

<span class="annotation">// getName</span>
String name = file.getName();
System.out.println(name);

<span class="annotation">// getPath</span>
String path = file.getPath();
System.out.println(path);

<span class="annotation">// getTotalSpace</span>
<span class="annotation">// getUsableSpace</span>
long totalSpace = file.getTotalSpace();
long usableSpace = file.getUsableSpace();
System.out.println("总空间：" + totalSpace / 1024 / 1024 / 1024 + "GB");
System.out.println("可用空间：" + usableSpace / 1024 / 1024 / 1024 + "GB");

<span class="annotation">// listRoots</span>
File[] roots = file.listRoots();
for (File f : roots) {
	System.out.println(f.getAbsolutePath());
}
</pre>

			<br />

			<p>
				传入一个 <code>File</code> 对象作为参数，首先输出该 <code>File</code> 对象的类型、名称、大小、最后修改时间，如果是一个目录，还要输出其子文件和目录的信息
			</p>
			<pre>
/*
	给出一个File对象
	首先输出该File对象的类型、名称、大小、最后修改时间
	如果是一个目录，还要输出其子文件和目录的信息
*/
private static void test1(File file) throws Exception {
	boolean isDir = file.isDirectory(); <span class="annotation">// 判断是否为目录</span>
	
	String name = file.getName(); <span class="annotation">// 获取文件名</span>
	long size = file.length() / 1024; <span class="annotation">// 获取文件大小</span>
	Date date = new Date(file.lastModified()); <span class="annotation">// 获取文件最后修改时间</span>

	SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd"); <span class="annotation">// 用来格式化修改时间</span>

	<span class="annotation">// 输出文件信息</span>
	System.out.println((isDir ? "d\t" : "f\t") + name + "\t" + size + "KB\t" + sdf.format(date));

	System.out.println();

	<span class="annotation">// 输出子文件信息</span>
	if(isDir) {
		File[] files = file.listFiles();
		for(File f : files) {
			boolean dir = f.isDirectory();

			name = f.getName();
			size = f.length() / 1024;
			date = new Date(f.lastModified());

			System.out.println((dir ? "d\t" : "f\t") + name + "\t" + size + "KB\t" + sdf.format(date));
		}
	}
}

public static void main(String[] args) {
	try {
		test1(new File("D:\\XXX"));
	} catch (Exception e) {
		e.printStackTrace();
	}
}

<span class="phase-title">输出：</span>

d	XXX	4KB	2017-05-16

d	书籍	4KB	2017-05-17
d	动漫	4KB	2017-05-16
d	操作系统	4KB	2017-05-16
d	教学视频(重要)	4KB	2017-05-16
d	电视剧	4KB	2017-05-16
</pre>

			<hr />

			<h4 id="f3" class="title-1th">三、递归删除目录</h4>

			<p>
				<code>File</code> 类的 <code>delete</code> 方法可以删除文件，但是只能删除空目录，也就是说 <code>File</code> 对象是目录且不为空时是无法删除的。如果需要删除一个目录时该怎么做呢？
			</p>
			<p>
				把目录中的子文件先删除，再删除该目录，如果子文件又是一个不为空的目录呢？
			</p>
			<p>
				所以，需要使用“递归”的方式一层一层的删除子目录及其文件才可以实现删除目录的需求。
			</p>
			<p>
				所谓的“递归”，就是在一个方法中调用本方法，但是在使用中如果没有适当的条件从递归方法中返回，方法就只进栈而无法出栈，最终导致内存溢出程序异常终止。
			</p>

			<pre>
public static void deleteFile(File file) throws Exception {
	if (file == null)
		throw new RuntimeException("参数文件不合理: " + null);

	if (file.isDirectory()) {
		<span class="annotation">// 如果是一个目录</span>
		<span class="annotation">// 获取子目录和文件数组</span>
		<span class="annotation">// 遍历全部子目录和文件</span>
		<span class="annotation">// 调用本方法逐一删除</span>
		File[] files = file.listFiles();
		for(File f : files) {
			deleteFile(f);
		}
		<span class="annotation">// 遍历完子目录和文件后删除自己</span>
		file.delete();
	} else {
		file.delete();
	}
}
</pre>

			<p>
				递归生成目录树
			</p>

			<pre>
/*
	使用递归生成目录树
*/
public static void listFiles(File dir, int level) {
	if (dir == null)
		throw new RuntimeException("参数文件不合理: " + null);

	System.out.println(format(level++) + dir.getName());
	if (dir.isDirectory()) {
		File[] fs = dir.listFiles();
		for (int i = 0; i < fs.length; i++)
			listFiles(fs[i], level);
	}
}

private static String format(int level) {
	StringBuilder builder = new StringBuilder();
	builder.append("|--");
	for (int i = 0; i < level; i++)
		builder.insert(0, "|  ");
	return builder.toString();
}
</pre>

			<span class="src-introduce">演示代码在项目 javanote 的 org.net5ijy.javanote.io 包中的 FileTest.java 文件。</span>

			<br /><br />

			<a href="java01038.html" style="font-size:12px;">第三十八节&nbsp;&nbsp;&nbsp;&nbsp;时间日期操作</a>
			<br />
			<a href="java01040.html" style="font-size:12px;">第四十节&nbsp;&nbsp;&nbsp;&nbsp;IO 流概述和字节流</a>

			<br /><br />

			加入 QQ 群：5ijy网站开发交流 <a target="_blank" href="http://shang.qq.com/wpa/qunwpa?idkey=3b6ff2e8f01c493cacf78d8eba9ec6362e85b447be8ed8b895d2da6cd5ae537d"><img border="0" src="http://pub.idqqimg.com/wpa/images/group.png" alt="5ijy网站开发交流" title="5ijy网站开发交流"></a>，获取更多源代码和开发环境配置信息。

		</div>
		
		<div class="footer">
			Copyright © 2017-2020 5ijy工作室.<br />
		</div>

		<div id="CfloatBtn" class="CfloatBtn" onclick="$('html,body').animate({'scrollTop': '0'},100);"></div>
	</body>
</html>
